<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>The Making of an MVP: Simple Invoice Web App &#8211; Tips and Tricks</title>
<meta name="description" content="">
<meta name="keywords" content="">
<!-- Twitter Cards -->
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="/images/">
<meta name="twitter:title" content="The Making of an MVP: Simple Invoice Web App">
<meta name="twitter:description" content="Mostly documentary production tips and tricks but als web dev stuff.">
<meta name="twitter:creator" content="@pietropassarell">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="The Making of an MVP: Simple Invoice Web App">
<meta property="og:description" content="Mostly documentary production tips and tricks but als web dev stuff.">
<meta property="og:url" content="/articles/mvp">
<meta property="og:site_name" content="Tips and Tricks">





<link rel="canonical" href="/articles/mvp">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Tips and Tricks Feed">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Google Webfonts -->
<link href='http://fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700|PT+Serif:400,700,400italic' rel='stylesheet' type='text/css'>
<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.min.css">

<!--[if (lt IE 9) & (!IEMobile)]>
<link rel="stylesheet" href="/assets/css/ie.min.css">
<![endif]-->

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body class="article" itemscope itemtype="http://schema.org/WebPage">

<!--[if lt IE 9]><div class="browser-upgrade alert alert-info">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]-->

<div class="navigation-wrapper">
	<div class="site-name">
		<a href="">Tips and Tricks</a>
	</div><!-- /.site-name -->
	<div class="top-navigation">
		<nav role="navigation" itemscope itemtype="http://schema.org/SiteNavigationElement">
		    <ul>
		        
				<li><a href="/about" >About</a></li>
		        
				<li><a href="/articles" >Articles</a></li>
		        
		        <li><i class="icon-feed"></i> <a href="/feed.xml" title="Atom/RSS feed">Feed</a>
		    </ul>
		</nav>
	</div><!-- /.top-navigation -->
</div><!-- /.navigation-wrapper -->



<div id="main" role="main" itemprop="mainContentOfPage" itemscope itemtype="http://schema.org/Blog">
  <div class="article-author-top">
    <img src="/images/bio-photo.jpg" class="bio-photo" alt="Pietro Passarelli bio photo"></a>
<h3>Pietro Passarelli</h3>
<p>Freelance Broadcast Shooting Researcher, learning to code.</p>



<a href="mailto:pietro.passarelli@gmail.com?Subject=Tips%20and%20Tricks&body=Hi Pietro, %0D%0A Was reading your Blog Tips and Tricks, and I've got a question..." class="author-social" target="_blank"><i class="icon-mail"></i> e-mail</a>


<a href="http://facebook.com/pietro.passarelli" class="author-social" target="_blank"><i class="icon-facebook"></i> Facebook</a>

<a href="http://twitter.com/pietropassarell" class="author-social" target="_blank"><i class="icon-twitter"></i> Twitter</a>

<a href="http://linkedin.com/in/pietropassarelli" class="author-social" target="_blank"><i class="icon-linkedin"></i> LinkedIn</a>



<a href="http://github.com/pietrop" class="author-social" target="_blank"><i class="icon-github"></i> Github</a>









  </div>
  <article itemscope itemtype="http://schema.org/BlogPosting" itemprop="blogPost">
    <div class="headline-wrap">
      <h1 itemprop="name">The Making of an MVP: Simple Invoice Web App</h1>
      <h2></h2>
    </div><!--/ .headline-wrap -->
    <div class="article-wrap" itemprop="text">
      <section id="table-of-contents" class="toc">
  <header>
    <h3>Contents</h3>
  </header>
<div id="drawer">
<ul id="markdown-toc">
  <li><a href="#mvc-inside-out">MVC inside out</a>    <ul>
      <li><a href="#rest-and-crud">REST and CRUD</a>        <ul>
          <li><a href="#modelling-users">Modelling users</a></li>
          <li><a href="#final-modelling-option">Final modelling option</a></li>
          <li><a href="#the-mvc-overview">The MVC Overview</a></li>
          <li><a href="#mvc-in-practice-for-invoice-resources">MVC in practice for Invoice resources</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#the-findorcreateby-activerecord-method">The find_or_create_by ActiveRecord method</a></li>
  <li><a href="#devise-easy-and-secure-authentication">Devise, easy and secure authentication</a></li>
  <li><a href="#bootstrap-layout-with-divs-and-rows">Bootstrap, layout with Divs and rows</a>    <ul>
      <li><a href="#bootstrap-and-css-templates---cosmo">Bootstrap and CSS templates - Cosmo</a></li>
    </ul>
  </li>
  <li><a href="#css-tweaks">CSS Tweaks</a>    <ul>
      <li><a href="#background-image-alex--seva-css-tip--explanation-code">Background image [alex + seva css tip + explanation code]</a></li>
    </ul>
  </li>
  <li><a href="#css-media-print">CSS media print</a></li>
  <li><a href="#deploy-to-heroku">deploy to Heroku</a></li>
  <li><a href="#add-devise-e-mail-verification">add Devise e-mail verification</a>    <ul>
      <li><a href="#add-confirmable">add confirmable</a></li>
      <li><a href="#migration-to-add-confirmationtoken">migration to add confirmation_token</a></li>
    </ul>
  </li>
  <li><a href="#config">config</a>    <ul>
      <li><a href="#in-dev-enviroment">in dev enviroment</a>        <ul>
          <li><a href="#adding-env-veriable">adding ENV Veriable</a>            <ul>
              <li><a href="#set-environment-variable-locally--unix--os-x">set environment variable locally , UNIX / Os x</a></li>
              <li><a href="#set-environment-variable-on-heroku">set environment variable on Heroku.</a></li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#making-a-pre-populated-e-mail-link">making a pre populated e-mail link</a>    <ul>
      <li><a href="#calculate-highest-rate">calculate highest rate</a></li>
    </ul>
  </li>
  <li><a href="#other">Other</a></li>
</ul>

  </div>
</section>
<!-- /#table-of-contents -->

<hr />

<p>MVP, minimum variable product. more then just mockups, more then just a slack front end, it needs to have the core essential features(only) and it needs to work.</p>

<h1 id="mvc-inside-out">MVC inside out</h1>

<h2 id="rest-and-crud">REST and CRUD</h2>
<p>REST - HTTP verbs match CRUD in controller, and we therefore thing of your model as resources, that can be created, read, updated and deleted.</p>

<p>This is all very well but, what does this mean in practice?</p>

<p>Let’s think of implementing sessions for users to sing and out for example, how would we frame that as resources that can be CRUD?</p>

<p>We could use devise for that […]</p>

<h3 id="modelling-users">Modelling users</h3>

<p>[diagram view of different possibilities, with table and ID field, and foreign key field]</p>

<h3 id="final-modelling-option">Final modelling option</h3>

<p>A user has_many invoices. Invoice belongs_to user</p>

<p>Invoices has_many notes, services,</p>

<p>A client has_many invoices.</p>

<p>a user has_one bank account</p>

<p>a invoice has_one bank account through: :user</p>

<h3 id="the-mvc-overview">The MVC Overview</h3>

<p>CRUD,</p>

<h3 id="mvc-in-practice-for-invoice-resources">MVC in practice for Invoice resources</h3>

<p>Using that example, prezi type of</p>

<hr />

<h1 id="the-findorcreateby-activerecord-method">The find_or_create_by ActiveRecord method</h1>

<hr />

<h1 id="devise-easy-and-secure-authentication">Devise, easy and secure authentication</h1>

<hr />

<h1 id="bootstrap-layout-with-divs-and-rows">Bootstrap, layout with Divs and rows</h1>

<h2 id="bootstrap-and-css-templates---cosmo">Bootstrap and CSS templates - Cosmo</h2>

<p><a href="http://bootswatch.com/cosmo/">http://bootswatch.com/cosmo/</a></p>

<p><a href="http://bootswatch.com">http://bootswatch.com</a></p>

<h1 id="css-tweaks">CSS Tweaks</h1>

<h3 id="background-image-alex--seva-css-tip--explanation-code">Background image [alex + seva css tip + explanation code]</h3>

<h1 id="css-media-print">CSS media print</h1>

<p>setting print friendly setting, a mvp shortcut to create a MVP.</p>

<h1 id="deploy-to-heroku">deploy to Heroku</h1>

<p>{ %raw }
    $ git push heroku master
  { %endraw }</p>

<p><a href="https://devcenter.heroku.com/articles/getting-started-with-rails4">Read more about deploying rails on heroku</a></p>

<p>if you need to reset heroku db</p>

<p>{ %raw }
   $ heroku pg:reset DATABASE –confirm YOUR_APP_NAME
   $ heroku run rake db:setup
   $ heroku restart
   $heroku open
  { %endraw }</p>

<p>To update CSS, HTML or other assets changes onto heroku</p>

<p>{ %raw }
  $ rake assets:precompile
  $ git add .
  $ git commit -am “description goes here”
  $ git push heroku master 
  $ heroku open
{ %endraw }</p>

<hr />

<h1 id="add-devise-e-mail-verification">add Devise e-mail verification</h1>

<p>http://blog.blazingcloud.net/2011/01/08/devise-authentication-in-rails-3/</p>

<h3 id="add-confirmable">add confirmable</h3>

<p>add confirmable to user model</p>

<div class="highlight"><pre><code class="ruby"><span class="k">class</span> <span class="nc">User</span> <span class="o">&lt;</span> <span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span>
  <span class="c1"># Include default devise modules. Others available are:</span>
  <span class="c1"># </span>
  <span class="c1"># :lockable, :timeoutable and :omniauthable</span>
  <span class="n">devise</span> <span class="ss">:database_authenticatable</span><span class="p">,</span> <span class="ss">:registerable</span><span class="p">,</span> <span class="ss">:confirmable</span><span class="p">,</span> <span class="ss">:token_authenticatable</span><span class="p">,</span> 
         <span class="ss">:recoverable</span><span class="p">,</span> <span class="ss">:rememberable</span><span class="p">,</span> <span class="ss">:trackable</span><span class="p">,</span> <span class="ss">:validatable</span>
  <span class="n">has_many</span> <span class="ss">:invoices</span> <span class="c1">#, dependant: :destroy</span>
  <span class="c1">#  has_many :notes , :through :invoices</span>
 <span class="c1">#  has_many :services, :through :invoices</span>

 <span class="n">has_one</span> <span class="ss">:bank</span>

 <span class="n">has_many</span> <span class="ss">:clients</span><span class="p">,</span> <span class="ss">through</span><span class="p">:</span> <span class="ss">:invoices</span>

 <span class="c1">#  has_many :clients, :through :invoices</span>
  
  <span class="n">validates</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">presence</span><span class="p">:</span> <span class="kp">true</span>
  <span class="n">validates</span> <span class="ss">:last_name</span><span class="p">,</span> <span class="ss">presence</span><span class="p">:</span> <span class="kp">true</span>
  <span class="n">validates</span> <span class="ss">:address</span><span class="p">,</span> <span class="ss">presence</span><span class="p">:</span> <span class="kp">true</span>
  <span class="n">validates</span> <span class="ss">:email</span><span class="p">,</span> <span class="ss">presence</span><span class="p">:</span> <span class="kp">true</span>
 

  <span class="n">validates</span> <span class="ss">:phone</span><span class="p">,</span> <span class="ss">presence</span><span class="p">:</span> <span class="kp">true</span><span class="p">,</span> <span class="ss">numericality</span><span class="p">:</span> <span class="kp">true</span>
<span class="k">end</span>
</code></pre></div>

<h3 id="migration-to-add-confirmationtoken">migration to add confirmation_token</h3>

<p>$ rails migration [how to set migration from terminal?]</p>

<div class="highlight"><pre><code class="ruby"><span class="k">class</span> <span class="nc">AddConfirmableToDevise</span> <span class="o">&lt;</span> <span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Migration</span>
  <span class="c1"># Note: You can&#39;t use change, as User.update_all with fail in the down migration</span>
  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">up</span>
    <span class="n">add_column</span> <span class="ss">:users</span><span class="p">,</span> <span class="ss">:confirmation_token</span><span class="p">,</span> <span class="ss">:string</span>
    <span class="n">add_column</span> <span class="ss">:users</span><span class="p">,</span> <span class="ss">:confirmed_at</span><span class="p">,</span> <span class="ss">:datetime</span>
    <span class="n">add_column</span> <span class="ss">:users</span><span class="p">,</span> <span class="ss">:confirmation_sent_at</span><span class="p">,</span> <span class="ss">:datetime</span>
    <span class="c1"># add_column :users, :unconfirmed_email, :string # Only if using reconfirmable</span>
    <span class="n">add_index</span> <span class="ss">:users</span><span class="p">,</span> <span class="ss">:confirmation_token</span><span class="p">,</span> <span class="ss">:unique</span> <span class="o">=&gt;</span> <span class="kp">true</span>
    <span class="c1"># User.reset_column_information # Need for some types of updates, but not for update_all.</span>
    <span class="c1"># To avoid a short time window between running the migration and updating all existing</span>
    <span class="c1"># users as confirmed, do the following</span>
    <span class="no">User</span><span class="o">.</span><span class="n">update_all</span><span class="p">(</span><span class="ss">:confirmed_at</span> <span class="o">=&gt;</span> <span class="no">Time</span><span class="o">.</span><span class="n">now</span><span class="p">)</span>
    <span class="c1"># All existing user accounts should be able to log in after this.</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">down</span>
    <span class="n">remove_column</span> <span class="ss">:users</span><span class="p">,</span> <span class="ss">:confirmation_token</span><span class="p">,</span> <span class="ss">:confirmed_at</span><span class="p">,</span> <span class="ss">:confirmation_sent_at</span>
    <span class="c1"># remove_column :users, :unconfirmed_email # Only if using reconfirmable</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>

<p>Run migration.</p>

<pre><code>$ rake db:migrate
</code></pre>

<p>reset database</p>

<pre><code>$ rake db:reset
</code></pre>

<h1 id="config">config</h1>

<h2 id="in-dev-enviroment">in dev enviroment</h2>

<p>https://devcenter.heroku.com/articles/config-vars#local-setup</p>

<p>https://devcenter.heroku.com/articles/procfile#developing-locally-with-foreman</p>

<pre><code>config/enviroments/development.rb 
</code></pre>

<p>add [check if code is it or if it’s more?]</p>

<div class="highlight"><pre><code class="ruby"><span class="n">config</span><span class="o">.</span><span class="n">action_mailer</span><span class="o">.</span><span class="n">raise_delivery_errors</span> <span class="o">=</span> <span class="kp">true</span> 
<span class="n">config</span><span class="o">.</span><span class="n">action_mailer</span><span class="o">.</span><span class="n">default_url_options</span> <span class="o">=</span> <span class="p">{</span> <span class="ss">:host</span> <span class="o">=&gt;</span> <span class="s1">&#39;localhost:3000&#39;</span> <span class="p">}</span>

<span class="ss">ActionMailer</span><span class="p">:</span><span class="ss">:Base</span><span class="o">.</span><span class="n">smtp_settings</span> <span class="o">=</span> <span class="p">{</span>
<span class="ss">:address</span> <span class="o">=&gt;</span> <span class="s1">&#39;smtp.gmail.com&#39;</span><span class="p">,</span>
<span class="ss">:port</span> <span class="o">=&gt;</span> <span class="mi">587</span><span class="p">,</span>
<span class="ss">:enable_starttls_auto</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span> 
<span class="ss">:domain</span> <span class="o">=&gt;</span> <span class="s1">&#39;gmail.com&#39;</span><span class="p">,</span>
<span class="ss">:authentication</span> <span class="o">=&gt;</span> <span class="ss">:plain</span><span class="p">,</span>
<span class="ss">:user_name</span> <span class="o">=&gt;</span> <span class="no">ENV</span><span class="o">[</span><span class="s2">&quot;GMAIL_USERNAME&quot;</span><span class="o">]</span><span class="p">,</span>
<span class="ss">:password</span> <span class="o">=&gt;</span> <span class="no">ENV</span><span class="o">[</span><span class="s2">&quot;GMAIL_PASSWORD&quot;</span><span class="o">]</span>
<span class="p">}</span>
</code></pre></div>

<p>Use development log to find token URL and verify it works.</p>

<p>“A message with a confirmation link has been sent to your email address. Please open the link to activate your account.”</p>

<h3 id="adding-env-veriable">adding ENV Veriable</h3>
<p>To make it more secure and hide your password and e-mail when sharing code on github or putting it up on heroku.</p>

<p>before </p>

<div class="highlight"><pre><code class="ruby">  <span class="n">config</span><span class="o">.</span><span class="n">action_mailer</span><span class="o">.</span><span class="n">raise_delivery_errors</span> <span class="o">=</span> <span class="kp">false</span>
  <span class="n">config</span><span class="o">.</span><span class="n">action_mailer</span><span class="o">.</span><span class="n">default_url_options</span> <span class="o">=</span> <span class="p">{</span><span class="ss">:host</span> <span class="o">=&gt;</span> <span class="s1">&#39;simpleinvoice.herokuapp.com&#39;</span><span class="p">}</span>

<span class="ss">ActionMailer</span><span class="p">:</span><span class="ss">:Base</span><span class="o">.</span><span class="n">smtp_settings</span> <span class="o">=</span> <span class="p">{</span>
<span class="ss">:address</span> <span class="o">=&gt;</span> <span class="s1">&#39;smtp.gmail.com&#39;</span><span class="p">,</span>
<span class="ss">:port</span> <span class="o">=&gt;</span> <span class="mi">587</span><span class="p">,</span>
<span class="ss">:enable_starttls_auto</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span> 
<span class="ss">:domain</span> <span class="o">=&gt;</span> <span class="s1">&#39;gmail.com&#39;</span><span class="p">,</span>
<span class="ss">:authentication</span> <span class="o">=&gt;</span> <span class="ss">:plain</span><span class="p">,</span>
<span class="ss">:user_name</span> <span class="o">=&gt;</span> <span class="n">your</span><span class="o">-</span><span class="n">email</span><span class="vi">@gmail</span><span class="o">.</span><span class="n">com</span><span class="p">,</span>
<span class="ss">:password</span> <span class="o">=&gt;</span> <span class="n">your</span><span class="o">-</span><span class="n">password</span>
<span class="p">}</span>
</code></pre></div>

<p>after</p>

<div class="highlight"><pre><code class="ruby">  <span class="n">config</span><span class="o">.</span><span class="n">action_mailer</span><span class="o">.</span><span class="n">raise_delivery_errors</span> <span class="o">=</span> <span class="kp">false</span>
  <span class="n">config</span><span class="o">.</span><span class="n">action_mailer</span><span class="o">.</span><span class="n">default_url_options</span> <span class="o">=</span> <span class="p">{</span><span class="ss">:host</span> <span class="o">=&gt;</span> <span class="s1">&#39;simpleinvoice.herokuapp.com&#39;</span><span class="p">}</span>

<span class="ss">ActionMailer</span><span class="p">:</span><span class="ss">:Base</span><span class="o">.</span><span class="n">smtp_settings</span> <span class="o">=</span> <span class="p">{</span>
<span class="ss">:address</span> <span class="o">=&gt;</span> <span class="s1">&#39;smtp.gmail.com&#39;</span><span class="p">,</span>
<span class="ss">:port</span> <span class="o">=&gt;</span> <span class="mi">587</span><span class="p">,</span>
<span class="ss">:enable_starttls_auto</span> <span class="o">=&gt;</span> <span class="kp">true</span><span class="p">,</span> 
<span class="ss">:domain</span> <span class="o">=&gt;</span> <span class="s1">&#39;gmail.com&#39;</span><span class="p">,</span>
<span class="ss">:authentication</span> <span class="o">=&gt;</span> <span class="ss">:plain</span><span class="p">,</span>
<span class="ss">:user_name</span> <span class="o">=&gt;</span> <span class="no">ENV</span><span class="o">[</span><span class="s2">&quot;GMAIL_USERNAME&quot;</span><span class="o">]</span><span class="p">,</span>
<span class="ss">:password</span> <span class="o">=&gt;</span> <span class="no">ENV</span><span class="o">[</span><span class="s2">&quot;GMAIL_PASSWORD&quot;</span><span class="o">]</span>
<span class="p">}</span>
</code></pre></div>

<p>you can read more about <a href="http://railsapps.github.io/rails-environment-variables.html">Rails ENV</a> here.</p>

<h4 id="set-environment-variable-locally--unix--os-x">set environment variable locally , UNIX / Os x</h4>

<p>TO set environment variable locally, in terminal to try it out:</p>

<pre><code>  $ export GMAIL_USERNAME="your-email@gmail.com"
  $ echo $GMAIL_USERNAME
  your-email@gmail.com
</code></pre>

<p>Uow would you do same for password ENV? yeah, you guessed it, same.</p>

<pre><code>  $ export GMAIL_PASSWORD="your-password"
  $ echo $GMAIL_PASSWORD
  your-password
</code></pre>

<p>if you made a mistake you can delete/revert back using unset</p>

<pre><code>$ unset GMAIL_USERNAME
$ echo $GMAIL_USERNAME
</code></pre>

<p>However if you are done playing a round and want to actually save the ENV so that they’ll be aviable on your next session, you can save them in bashrc</p>

<p>in terminal</p>

<p>$ vim ~/.bashrc</p>

<p>ad adding the two lines in ~/.bashrc</p>

<pre><code> $ export GMAIL_USERNAME="your-email@gmail.com"
 $ export GMAIL_PASSWORD="your-password"
</code></pre>

<p>Read more about <a href="http://cli.learncodethehardway.org/book/ex22.html">changing ENV</a> or <a href="http://cli.learncodethehardway.org/book/ex21.html">exploring ENV</a></p>

<h4 id="set-environment-variable-on-heroku">set environment variable on Heroku.</h4>

<p>Read more about how to <a href="https://devcenter.heroku.com/articles/config-vars">set ENV on heroku</a> on deployment</p>

<p>if you need to reset the database:</p>

<pre><code>$ rake db:migrate:reset 
  

  
$  rake db:reset
</code></pre>

<p>$ heroku config:add GMAIL_USERNAME=myname@gmail.com
$ heroku config:add GMAIL_PASSWORD=yourpassword</p>

<h1 id="making-a-pre-populated-e-mail-link">making a pre populated e-mail link</h1>

<p>in erb </p>

<div class="highlight"><pre><code class="ruby">  <span class="o">&lt;</span><span class="sx">%= mail_to @client.email, @client.email, :bcc =</span><span class="o">&gt;</span> <span class="vi">@user</span><span class="o">.</span><span class="n">email</span><span class="p">,</span>
         <span class="ss">:subject</span> <span class="o">=&gt;</span> <span class="s2">&quot;Invoice&quot;</span><span class="p">,</span> <span class="ss">:body</span> <span class="o">=&gt;</span> <span class="s2">&quot;Dear </span><span class="si">#{</span><span class="vi">@client</span><span class="o">.</span><span class="n">contact_name</span><span class="si">}</span><span class="s2">, </span><span class="se">\n</span><span class="s2"> I&#39;m writing regarding the last invoice (Invoice number </span><span class="si">#{</span><span class="vi">@client</span><span class="o">.</span><span class="n">invoices</span><span class="o">.</span><span class="n">order</span><span class="p">(</span><span class="s2">&quot;number desc&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">last</span><span class="o">.</span><span class="n">number</span><span class="si">}</span><span class="s2"> ) of the </span><span class="si">#{</span><span class="vi">@client</span><span class="o">.</span><span class="n">invoices</span><span class="o">.</span><span class="n">order</span><span class="p">(</span><span class="s2">&quot;number desc&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">last</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%d-%h-%y&quot;</span> <span class="p">)</span><span class="si">}</span><span class="s2">, </span><span class="se">\n</span><span class="s2"> for the period between the </span><span class="si">#{</span><span class="vi">@client</span><span class="o">.</span><span class="n">invoices</span><span class="o">.</span><span class="n">order</span><span class="p">(</span><span class="s2">&quot;number desc&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">last</span><span class="o">.</span><span class="n">services</span><span class="o">.</span><span class="n">order</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%d-%h-%y&quot;</span> <span class="p">)</span><span class="si">}</span><span class="s2"> and the </span><span class="si">#{</span><span class="vi">@client</span><span class="o">.</span><span class="n">invoices</span><span class="o">.</span><span class="n">order</span><span class="p">(</span><span class="s2">&quot;number desc&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">last</span><span class="o">.</span><span class="n">services</span><span class="o">.</span><span class="n">order</span><span class="p">(</span><span class="s2">&quot;date&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%d-%h-%y&quot;</span> <span class="p">)</span><span class="si">}</span><span class="s2">. </span><span class="se">\n</span><span class="s2"> </span><span class="se">\n</span><span class="s2"> I was wondering if you could look into weather it is overdue. </span><span class="se">\n</span><span class="s2"> </span><span class="se">\n</span><span class="s2">  Best </span><span class="se">\n</span><span class="s2"> </span><span class="se">\n</span><span class="s2">  </span><span class="si">#{</span><span class="vi">@user</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">%&gt;</span>
</code></pre></div>

<p>in html</p>

<div class="highlight"><pre><code class="html"><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;mailto:your-email@gmail.com?Subject=Tips%20and%20Tricks&amp;body=Hi Pietro, %0D%0A Was reading your Blog Tips and Tricks, and I&#39;ve got a question...&quot;</span> <span class="na">class=</span><span class="s">&quot;author-social&quot;</span> <span class="na">target=</span><span class="s">&quot;_blank&quot;</span><span class="nt">&gt;&lt;i</span> <span class="na">class=</span><span class="s">&quot;icon-mail&quot;</span><span class="nt">&gt;&lt;/i&gt;</span> e-mail<span class="nt">&lt;/a&gt;</span>
</code></pre></div>

<p><a href="mailto:your-email@gmail.com?Subject=Tips%20and%20Tricks&amp;body=Hi Pietro, %0D%0A Was reading your Blog Tips and Tricks, and I've got a question..." class="author-social" target="_blank"><i class="icon-mail"></i> e-mail</a></p>

<p>to add a space use  %20
to add a new line use   %0D%0A</p>

<h2 id="calculate-highest-rate">calculate highest rate</h2>

<p>Active record, </p>

<p>in model 
made :client has_many :services,  through: :invoices</p>

<p>and invoice belong to client </p>

<p>to then being able to write this:</p>

<div class="highlight"><pre><code class="ruby">  <span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span>
    <span class="no">Highest</span> <span class="ss">Rate</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">strong</span><span class="o">&gt;</span> <span class="err">£</span> <span class="o">&lt;</span><span class="sx">%= @client.services.order(&#39;rate DESC&#39;).first.rate %&gt;&lt;/strong&gt;, &lt;%=</span> <span class="vi">@client</span><span class="o">.</span><span class="n">services</span><span class="o">.</span><span class="n">order</span><span class="p">(</span><span class="s1">&#39;rate DESC&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">unit_type</span> <span class="sx">%&gt; </span>
<span class="sx">  &lt;/p&gt;</span>
</code></pre></div>

<ul>
  <li>it orders the services for the client, by rate and sorts our the ret in Descending order(highest number first) </li>
  <li>by then picking the .first element of that order/list </li>
  <li>I can ask for the rate of that element.</li>
</ul>

<p>I also did the same for the lowest rate by using ASC instead of DESC.
Ascending(lowest number first)</p>

<p>possible Variation: if instead I wanted the first 5, instead of .first I would have .limit(5)</p>

<h1 id="other">Other</h1>

<p>step2 (for form,selection)</p>

<p>in line editing with JQuery.</p>


      <hr />
      <footer role="contentinfo">
        <div class="article-author-bottom">
          <img src="/images/bio-photo.jpg" class="bio-photo" alt="Pietro Passarelli bio photo"></a>
<h3>Pietro Passarelli</h3>
<p>Freelance Broadcast Shooting Researcher, learning to code.</p>



<a href="mailto:pietro.passarelli@gmail.com?Subject=Tips%20and%20Tricks&body=Hi Pietro, %0D%0A Was reading your Blog Tips and Tricks, and I've got a question..." class="author-social" target="_blank"><i class="icon-mail"></i> e-mail</a>


<a href="http://facebook.com/pietro.passarelli" class="author-social" target="_blank"><i class="icon-facebook"></i> Facebook</a>

<a href="http://twitter.com/pietropassarell" class="author-social" target="_blank"><i class="icon-twitter"></i> Twitter</a>

<a href="http://linkedin.com/in/pietropassarelli" class="author-social" target="_blank"><i class="icon-linkedin"></i> LinkedIn</a>



<a href="http://github.com/pietrop" class="author-social" target="_blank"><i class="icon-github"></i> Github</a>









        </div>
        <p class="byline"><strong>The Making of an MVP: Simple Invoice Web App</strong> was published on <time datetime="2013-09-01T15:09:10+01:00" itemprop="datePublished">September 01, 2013</time> by <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name"><a href="/about" title="About Pietro Passarelli" itemprop="url">Pietro Passarelli</a></span></span>.</p>
      </footer>
    </div><!-- /.article-wrap -->
  </article>
</div><!-- /#main -->

<div class="footer-wrap">
  <div class="related-articles">
  <h4>You might also enjoy <small class="pull-right">(<a href="/articles">View all articles</a>)</small></h4>
    <ul>
    
      
      
      
    
      
      
      
      <li><a href="/code/articles/dev-setup" title="Dev Enviroment setup">Dev Enviroment setup</a></li>
      
    
      
      
      
      <li><a href="/media/articles/cv-sailing" title="CV for maretime industry">CV for maretime industry</a></li>
      
    
    </ul>
    <hr />
  </div><!-- /.related-articles -->
  <footer>
    <span>&copy; 2013 Pietro Passarelli. Powered by <a href="http://jekyllrb.com">Jekyll</a> using the <a href="http://mademistakes.com/">Minimal Mistakes</a> theme.</span>

  </footer>
</div><!-- /.footer-wrap -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>
	        

</body>
</html>
