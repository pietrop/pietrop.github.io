<!DOCTYPE html>
<html lang="en-us">

<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      issu.com pdf downloader &middot; Pietro
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700%7CPT+Sans:400">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-precomposed.png">
  <!-- <link rel="shortcut icon" href="/public/favicon.ico"> -->

    <!-- ////////// Favicon ////////// -->
      <!-- For old IEs -->
    <link rel="shortcut icon" href="/public/favicon.ico/favicon.ico" />

    <!-- For new browsers - multisize ico  -->
    <link rel="icon" type="image/x-icon" sizes="16x16 32x32" href="/public/favicon.ico/favicon.ico">

    <!-- For iPad with high-resolution Retina display running iOS ≥ 7: -->
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="/public/favicon.ico/favicon-152.png">

    <!-- For iPad with high-resolution Retina display running iOS ≤ 6: -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/favicon.ico/favicon-144.png">

    <!-- For iPhone with high-resolution Retina display running iOS ≥ 7: -->
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="/public/favicon.ico/favicon-120.png">

    <!-- For iPhone with high-resolution Retina display running iOS ≤ 6: -->
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="/public/favicon.ico/favicon-114.png">

    <!-- For iPhone 6+ -->
    <link rel="apple-touch-icon-precomposed" sizes="180x180" href="/public/favicon.ico/favicon-180.png">

    <!-- For first- and second-generation iPad: -->
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="/public/favicon.ico/favicon-72.png">

    <!-- For non-Retina iPhone, iPod Touch, and Android 2.1+ devices: -->
    <link rel="apple-touch-icon-precomposed" href="/public/favicon.ico/favicon-57.png">

    <!-- For Old Chrome -->
    <link rel="icon" href="/public/favicon.ico/favicon-32.png" sizes="32x32">

    <!-- For IE10 Metro -->
    <meta name="msapplication-TileColor" content="#FFFFFF">
    <meta name="msapplication-TileImage" content="favicon-144.png">
    <meta name="theme-color" content="#ffffff">

    <!-- Chrome for Android -->
    <link rel="manifest" href="manifest.json">
    <link rel="icon" sizes="192x192" href="/public/favicon.ico/favicon-192.png">
    <!-- ////////// Favicons end ////////// -->


  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
  <!-- font awesome CDN -->
  <script src="https://use.fontawesome.com/84dfffd1e8.js"></script>
</head>


<body>

  <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
 styles, `#sidebar-checkbox` for behavior. -->
 <input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

 <!-- Toggleable sidebar -->
 <div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p>Tips Tricks & Quick Fix by <a href='http://twitter.com/pietropassarell' target='_blank'>@pietropassarell</a>i.</p>
  </div>

  <nav class="sidebar-nav">

    

    <a class="sidebar-nav-item" href="/"><i class="fa fa-user" aria-hidden="true"></i> About</a>

    
    <a class="sidebar-nav-item" href="/categories/photos">
      
      <i class="fa fa-camera-retro" aria-hidden="true"></i> Photos
      
    </a>

    
    <a class="sidebar-nav-item" href="/categories/video">
      
      <i class="fa fa-film" aria-hidden="true"></i> Video
      
    </a>

    
    <a class="sidebar-nav-item" href="/categories/ttqf">
      
      <i class="fa fa-list-alt" aria-hidden="true"></i> Tips Tricks & Quick Fix
      
    </a>

    
    <a class="sidebar-nav-item" href="/categories/blog">
      
      <i class="fa fa-pencil" aria-hidden="true"></i> Blog
      
    </a>

    
    <a class="sidebar-nav-item" href="/categories/tech">
      
      <i class="fa fa-laptop" aria-hidden="true"></i> Tech
      
    </a>

    

    <a class="icon-envelope  sidebar-nav-item" href="mailto:pietro.passarelli@gmail.com?Subject=Hello&body=Hi Pietro, %0D%0A Was reading your website, and I've got a question..." class="author-social" target="_blank"><i class="icon-mail"></i><i class="fa fa-envelope-o" aria-hidden="true"></i> E-mail</a> <span ></span>


    <a class="icon-twitter  sidebar-nav-item " href="https://twitter.com/pietropassarell"  target="_blank"> <i class="fa fa-twitter" aria-hidden="true"></i> Twitter</a>

    <a class="icon-github sidebar-nav-item " href="https://github.com/pietrop"  target="_blank"><i class="fa fa-github" aria-hidden="true"></i> GitHub</a>

  </div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
    content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
            <a href="/" title="Home">Pietro</a>
            <small>Passarelli</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="post">
  <h1 class="post-title">issu.com pdf downloader </h1>
  <span class="post-date">30 Jun 2014  

 
</span>

 <small><a href="https://github.com/pietrop/issuu.com-downloader"  target="_blank"><i class="fa fa-github" aria-hidden="true"></i> GitHub</a>,</small>

<!-- optional gitbook link -->



 <!-- project page -->






<br>


<!-- Stack -->
 
<br>

a ruby script to download pdfs from issu.com, when the download option has been disabled.



 <hr>


  <p><strong>Problem</strong>: I wanted to read the <a href="http://issuu.com/swroblewska/docs/j64913_sheff_doc_fest_inner_whole_s">Sheffield DocFest “Decision Makers Guide 2014”</a> but can’t stand having to read of <code class="highlighter-rouge">issu.com</code>, just wanted a nice downloadable pdf, but the pdf download option that is generally under the share button was disabled.</p>

<p><strong>Solution</strong>: I decide to see if I could extract the images that make up the flash object of the site and combine them into a pdf.<br />
First thing first identifying the element id. clicking on white part of the page and inspecting the page in chrome, I found the <code class="highlighter-rouge">id=readerreader</code></p>

<div class="image-wrapper">
    <img src="http://1.bp.blogspot.com/-Bu2Bw7_tHjs/U683ZFxKIfI/AAAAAAAAFdM/e_3_4rqBQSc/s1600/Screen+Shot+2014-06-28+at+22.25.43.png" alt="" />
</div>

<p>and under the object <code class="highlighter-rouge">type="application/x-shockwave-flash"</code> I found the <code class="highlighter-rouge">documentId=140601160255-3a4c0f75ec731801ef369f5000f03104</code></p>

<p>Looking on stack overflow I worked out the following URL: <code class="highlighter-rouge">http://image.issuu.com/140601160255-3a4c0f75ec731801ef369f5000f03104/jpg/page_5.jpg</code> , where <code class="highlighter-rouge">140601160255-3a4c0f75ec731801ef369f5000f03104</code> is the id of the article, gives you each page as a jpg file that builds up the online magazine on <code class="highlighter-rouge">issue.com</code> named with an incremental count.</p>

<p>And what follows is the code I wrote in ruby and run from terminal</p>

<figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="nv">$ruby</span> issuu_downloader.rb</code></pre></figure>

<p>I used the <code class="highlighter-rouge">Mechanize Gem</code> to download the images, and the <code class="highlighter-rouge">prawn gem</code> to combine them into a pdf.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="nb">require</span> <span class="s1">'mechanize'</span>
<span class="nb">require</span> <span class="s1">'prawn'</span>

<span class="c1">########1.Looping through the page to download them</span>
<span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">1</span><span class="p">.</span><span class="nf">.</span><span class="mi">104</span>
  <span class="nb">print</span> <span class="s2">"downloading</span><span class="se">\t</span><span class="s2">page n </span><span class="si">#{</span><span class="n">i</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span>
<span class="n">agent</span> <span class="o">=</span> <span class="no">Mechanize</span><span class="p">.</span><span class="nf">new</span>
<span class="n">link</span> <span class="o">=</span> <span class="s2">"http://image.issuu.com/140601160255-3a4c0f75ec731801ef369f5000f03104/jpg/page_</span><span class="si">#{</span><span class="n">i</span><span class="p">.</span><span class="nf">to_s</span><span class="si">}</span><span class="s2">.jpg"</span>
<span class="n">agent</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">link</span><span class="p">).</span><span class="nf">save</span> <span class="s2">"page_</span><span class="si">#{</span><span class="n">i</span><span class="p">.</span><span class="nf">to_s</span><span class="si">}</span><span class="s2">.jpg"</span>
<span class="nb">print</span> <span class="s2">"downloaded</span><span class="se">\t</span><span class="s2">page n </span><span class="si">#{</span><span class="n">i</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span>
<span class="k">end</span>

<span class="nb">print</span> <span class="s2">"images from 1 to 104 downloaded as jpg</span><span class="se">\n</span><span class="s2">"</span>

<span class="c1">########2. Combine all the images into a pdf</span>

<span class="no">Prawn</span><span class="o">::</span><span class="no">Document</span><span class="p">.</span><span class="nf">generate</span><span class="p">(</span><span class="s2">"DocFest_Decision Makers Guide 2014.pdf"</span><span class="p">,</span> <span class="ss">:page_layout</span> <span class="o">=&gt;</span> <span class="ss">:portrait</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">pdf</span><span class="o">|</span>
   <span class="c1"># pdf.text("Hello Prawn!")</span>

<span class="p">(</span><span class="mi">1</span><span class="p">.</span><span class="nf">.</span><span class="mi">104</span><span class="p">).</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span>
    <span class="n">pdf</span><span class="p">.</span><span class="nf">image</span> <span class="s2">"page_</span><span class="si">#{</span><span class="n">i</span><span class="p">.</span><span class="nf">to_s</span><span class="si">}</span><span class="s2">.jpg"</span><span class="p">,</span> <span class="ss">:at</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">750</span><span class="p">],</span> <span class="ss">:width</span> <span class="o">=&gt;</span> <span class="mi">530</span>
<span class="n">pdf</span><span class="p">.</span><span class="nf">start_new_page</span>
<span class="k">end</span><span class="c1">#end of loop</span>
<span class="k">end</span><span class="c1">#end of prawn</span></code></pre></figure>

<p>Let’s just break it down in pseudo code for a second, as we can see it articulates into two parts</p>

<ol>
  <li>
    <p>Loop through page numbers substituting them in the URL, and save locally.<br />
(after all without this script this is what I would have done manually)</p>
  </li>
  <li>
    <p>combine all the downloaded images into a pdf<br />
(again I would have probably done this with preview or automator on os x “manually”</p>
  </li>
</ol>

<h2 id="downloading-the-images">1. Downloading the Images</h2>

<p>Let’s look at the first part first, downloading the images.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="nb">require</span> <span class="s1">'mechanize'</span>

<span class="c1">########Looping through the page to download them</span>
<span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">1</span><span class="p">.</span><span class="nf">.</span><span class="mi">104</span>
  <span class="nb">print</span> <span class="s2">"downloading</span><span class="se">\t</span><span class="s2">page n </span><span class="si">#{</span><span class="n">i</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span>
<span class="n">agent</span> <span class="o">=</span> <span class="no">Mechanize</span><span class="p">.</span><span class="nf">new</span>
<span class="n">link</span> <span class="o">=</span> <span class="s2">"http://image.issuu.com/140601160255-3a4c0f75ec731801ef369f5000f03104/jpg/page_</span><span class="si">#{</span><span class="n">i</span><span class="p">.</span><span class="nf">to_s</span><span class="si">}</span><span class="s2">.jpg"</span>
<span class="n">agent</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">link</span><span class="p">).</span><span class="nf">save</span> <span class="s2">"page_</span><span class="si">#{</span><span class="n">i</span><span class="p">.</span><span class="nf">to_s</span><span class="si">}</span><span class="s2">.jpg"</span>
<span class="nb">print</span> <span class="s2">"downloaded</span><span class="se">\t</span><span class="s2">page n </span><span class="si">#{</span><span class="n">i</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span>
<span class="k">end</span></code></pre></figure>

<p>print “images from 1 to 104 downloaded as jpg\n”</p>

<p>I knew the pages where 104, so I fought a loop would have been a good fit.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">1</span><span class="p">.</span><span class="nf">.</span><span class="mi">104</span>
   <span class="c1">#change the URL with string interpolation #{i} to change the page number</span>
<span class="k">end</span> </code></pre></figure>

<p>I then added the mechanise gem at the top with</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="nb">require</span> <span class="s1">'mechanise'</span></code></pre></figure>

<p>within the loop I created a new mechanise object and assigned it to a variable agent</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">agent</span> <span class="o">=</span> <span class="no">Mechanize</span><span class="p">.</span><span class="nf">new</span></code></pre></figure>

<p>and also within the loop assigned the link to a variable link, where i is the number in the loop, and I’ve added a .to_s method to convert it to string to avoid any problem in the parsing of the URL.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">link</span> <span class="o">=</span> <span class="s2">"http://image.issuu.com/140601160255-3a4c0f75ec731801ef369f5000f03104/jpg/page_</span><span class="si">#{</span><span class="n">i</span><span class="p">.</span><span class="nf">to_s</span><span class="si">}</span><span class="s2">.jpg"</span></code></pre></figure>

<p>with these two key elements in place, I went about using the mechanise method get on the link, and then saving it, giving it the page name, using the string interpolation of the loop number for the page name.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="s2">"page_</span><span class="si">#{</span><span class="n">i</span><span class="p">.</span><span class="nf">to_s</span><span class="si">}</span><span class="s2">.jpg"</span>
<span class="n">agent</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">link</span><span class="p">).</span><span class="nf">save</span> <span class="s2">"page_</span><span class="si">#{</span><span class="n">i</span><span class="p">.</span><span class="nf">to_s</span><span class="si">}</span><span class="s2">.jpg"</span></code></pre></figure>

<p>I then added a couple of comments to print out what was going on to get some feedback in terminal while the program was running, and here it is this first part of the problem solved.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="nb">require</span> <span class="s1">'mechanize'</span>

<span class="c1">########Looping through the page to download them</span>
<span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">1</span><span class="p">.</span><span class="nf">.</span><span class="mi">104</span>
  <span class="nb">print</span> <span class="s2">"downloading</span><span class="se">\t</span><span class="s2">page n </span><span class="si">#{</span><span class="n">i</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span>
<span class="n">agent</span> <span class="o">=</span> <span class="no">Mechanize</span><span class="p">.</span><span class="nf">new</span>
<span class="n">link</span> <span class="o">=</span> <span class="s2">"http://image.issuu.com/140601160255-3a4c0f75ec731801ef369f5000f03104/jpg/page_</span><span class="si">#{</span><span class="n">i</span><span class="p">.</span><span class="nf">to_s</span><span class="si">}</span><span class="s2">.jpg"</span>
<span class="n">agent</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">link</span><span class="p">).</span><span class="nf">save</span> <span class="s2">"page_</span><span class="si">#{</span><span class="n">i</span><span class="p">.</span><span class="nf">to_s</span><span class="si">}</span><span class="s2">.jpg"</span>
<span class="nb">print</span> <span class="s2">"downloaded</span><span class="se">\t</span><span class="s2">page n </span><span class="si">#{</span><span class="n">i</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span>
<span class="k">end</span>

<span class="nb">print</span> <span class="s2">"images from 1 to 104 downloaded as jpg</span><span class="se">\n</span><span class="s2">"</span></code></pre></figure>

<h2 id="combining-images-into-one-pdf">2. Combining images into one pdf</h2>

<p>Then for the second part of the problem, combining the images into a pdf I decided to use the gem prawn.<br />
require ‘prawn’<br />
and the idea here is that first you generate a pdf, setting, page layout as portrait,</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="no">Prawn</span><span class="o">::</span><span class="no">Document</span><span class="p">.</span><span class="nf">generate</span><span class="p">(</span><span class="s2">"DocFest_Decision Makers Guide 2014.pdf"</span><span class="p">,</span> <span class="ss">:page_layout</span> <span class="o">=&gt;</span> <span class="ss">:portrait</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">pdf</span><span class="o">|</span></code></pre></figure>

<p>then I looped through the page number range, adding the jpeg files I saved in the first half of the problem to the pdf object I am creating.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="p">(</span><span class="mi">1</span><span class="p">.</span><span class="nf">.</span><span class="mi">104</span><span class="p">).</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span>
    <span class="n">pdf</span><span class="p">.</span><span class="nf">image</span> <span class="s2">"page_</span><span class="si">#{</span><span class="n">i</span><span class="p">.</span><span class="nf">to_s</span><span class="si">}</span><span class="s2">.jpg"</span><span class="p">,</span> <span class="ss">:at</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">750</span><span class="p">],</span> <span class="ss">:width</span> <span class="o">=&gt;</span> <span class="mi">530</span></code></pre></figure>

<p>after each page is created I used the method <code class="highlighter-rouge">start_new_page</code> on the pdf object.<br />
<code class="highlighter-rouge">pdf.start_new_page</code><br />
And here it is the second half of the solution all together.</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="nb">require</span> <span class="s1">'prawn'</span>

<span class="c1">########to combine all the images into a pdf</span>

<span class="no">Prawn</span><span class="o">::</span><span class="no">Document</span><span class="p">.</span><span class="nf">generate</span><span class="p">(</span><span class="s2">"DocFest_Decision Makers Guide 2014.pdf"</span><span class="p">,</span> <span class="ss">:page_layout</span> <span class="o">=&gt;</span> <span class="ss">:portrait</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">pdf</span><span class="o">|</span>

<span class="p">(</span><span class="mi">1</span><span class="p">.</span><span class="nf">.</span><span class="mi">104</span><span class="p">).</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">i</span><span class="o">|</span>
    <span class="n">pdf</span><span class="p">.</span><span class="nf">image</span> <span class="s2">"page_</span><span class="si">#{</span><span class="n">i</span><span class="p">.</span><span class="nf">to_s</span><span class="si">}</span><span class="s2">.jpg"</span><span class="p">,</span> <span class="ss">:at</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">750</span><span class="p">],</span> <span class="ss">:width</span> <span class="o">=&gt;</span> <span class="mi">530</span>
<span class="n">pdf</span><span class="p">.</span><span class="nf">start_new_page</span>
<span class="k">end</span><span class="c1">#end of loop</span>
<span class="k">end</span><span class="c1">#end of prawn</span></code></pre></figure>

<h3 id="generalising-the-solution">Generalising the solution</h3>

<p>Last but not least I decided to change the code so that if I want to use it for another magazine on issue.com I can get the prompt from the terminal to add magazine name, page count, and document-id and therefore generalised the solution to the initial problem.<br />
The resulting code is as follow (also on <a href="https://github.com/pietrop/issuu.com-downloader">github</a>):</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="nb">require</span> <span class="s1">'mechanize'</span>
<span class="nb">require</span> <span class="s1">'prawn'</span>
<span class="n">prompt</span> <span class="o">=</span> <span class="s2">"&gt; "</span>

<span class="nb">puts</span> <span class="s2">"What is the name of the magazine you'd like to download from issuu.com? ps: this will be the name of your pdf file</span><span class="se">\n</span><span class="s2">"</span>
<span class="nb">print</span> <span class="n">prompt</span>
<span class="n">magazine_name</span> <span class="o">=</span> <span class="nb">gets</span><span class="p">.</span><span class="nf">chomp</span>


<span class="nb">puts</span> <span class="s2">"How many pages does it have?</span><span class="se">\n</span><span class="s2"> ie 104</span><span class="se">\n</span><span class="s2">"</span>
<span class="nb">print</span> <span class="n">prompt</span>
<span class="n">page_number</span> <span class="o">=</span> <span class="nb">gets</span><span class="p">.</span><span class="nf">chomp</span>

<span class="nb">puts</span> <span class="s2">"document Id? </span><span class="se">\n</span><span class="s2"> to get the 'document-id' inspect page in chrome,</span><span class="se">\n</span><span class="s2"> search for document-id and paste here,</span><span class="se">\n</span><span class="s2"> ie 140601160255-3a4c0f75ec731801ef369f5000f03104</span><span class="se">\n</span><span class="s2">"</span>
<span class="nb">print</span> <span class="n">prompt</span>
<span class="n">document_id</span> <span class="o">=</span> <span class="nb">gets</span><span class="p">.</span><span class="nf">chomp</span>

<span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">1</span><span class="p">.</span><span class="nf">.</span><span class="n">page_number</span><span class="p">.</span><span class="nf">to_i</span>
  <span class="nb">print</span> <span class="s2">"downloading</span><span class="se">\t</span><span class="s2">page n </span><span class="si">#{</span><span class="n">i</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span>
  <span class="n">agent</span> <span class="o">=</span> <span class="no">Mechanize</span><span class="p">.</span><span class="nf">new</span>
  <span class="n">link</span> <span class="o">=</span> <span class="s2">"http://image.issuu.com/</span><span class="si">#{</span><span class="n">document_id</span><span class="p">.</span><span class="nf">to_s</span><span class="si">}</span><span class="s2">/jpg/page_</span><span class="si">#{</span><span class="n">i</span><span class="p">.</span><span class="nf">to_s</span><span class="si">}</span><span class="s2">.jpg"</span>
  <span class="n">agent</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">link</span><span class="p">).</span><span class="nf">save</span> <span class="s2">"page_</span><span class="si">#{</span><span class="n">i</span><span class="p">.</span><span class="nf">to_s</span><span class="si">}</span><span class="s2">.jpg"</span>
  <span class="nb">print</span> <span class="s2">"downloaded</span><span class="se">\t</span><span class="s2">page n </span><span class="si">#{</span><span class="n">i</span><span class="si">}</span><span class="se">\n</span><span class="s2">"</span>
<span class="k">end</span>

<span class="nb">print</span> <span class="s2">"images from 1 to </span><span class="si">#{</span><span class="n">page_number</span><span class="p">.</span><span class="nf">to_s</span><span class="si">}</span><span class="s2"> downloaded as jpg</span><span class="se">\n</span><span class="s2">"</span>

<span class="c1">########to combine all images into a pdf</span>

<span class="no">Prawn</span><span class="o">::</span><span class="no">Document</span><span class="p">.</span><span class="nf">generate</span><span class="p">(</span><span class="s2">"</span><span class="si">#{</span><span class="n">magazine_name</span><span class="si">}</span><span class="s2">.pdf"</span><span class="p">,</span> <span class="ss">:page_layout</span> <span class="o">=&gt;</span> <span class="ss">:portrait</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">pdf</span><span class="o">|</span>

  <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">1</span><span class="p">.</span><span class="nf">.</span><span class="n">page_number</span><span class="p">.</span><span class="nf">to_i</span>
      <span class="n">pdf</span><span class="p">.</span><span class="nf">image</span> <span class="s2">"page_</span><span class="si">#{</span><span class="n">i</span><span class="p">.</span><span class="nf">to_s</span><span class="si">}</span><span class="s2">.jpg"</span><span class="p">,</span> <span class="ss">:at</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">750</span><span class="p">],</span> <span class="ss">:width</span> <span class="o">=&gt;</span> <span class="mi">530</span>
      <span class="n">pdf</span><span class="p">.</span><span class="nf">start_new_page</span>
  <span class="k">end</span><span class="c1">#end of loop</span>
<span class="k">end</span>

<span class="nb">print</span> <span class="s2">"images from 1 to </span><span class="si">#{</span><span class="n">page_number</span><span class="p">.</span><span class="nf">to_s</span><span class="si">}</span><span class="s2"> combined into pdf </span><span class="se">\n</span><span class="s2">"</span>

<span class="c1">########to delete all images, once pdf as been created, to clean up a bit</span>
<span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="mi">1</span><span class="p">.</span><span class="nf">.</span><span class="n">page_number</span><span class="p">.</span><span class="nf">to_i</span>
  <span class="no">File</span><span class="p">.</span><span class="nf">delete</span><span class="p">(</span><span class="s2">"page_</span><span class="si">#{</span><span class="n">i</span><span class="p">.</span><span class="nf">to_s</span><span class="si">}</span><span class="s2">.jpg"</span><span class="p">)</span>
<span class="k">end</span><span class="c1">#end of prawn</span>

<span class="nb">print</span> <span class="s2">"images from 1 to </span><span class="si">#{</span><span class="n">page_number</span><span class="p">.</span><span class="nf">to_s</span><span class="si">}</span><span class="s2"> deleted </span><span class="se">\n</span><span class="s2">"</span>
<span class="c1"># print "your pdf #{magazine_name}.pdf is in: \n #{Dir.pwd}"</span></code></pre></figure>

</div>


      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>
    (function(document) {
      var toggle = document.querySelector('.sidebar-toggle');
      var sidebar = document.querySelector('#sidebar');
      var checkbox = document.querySelector('#sidebar-checkbox');

      document.addEventListener('click', function(e) {
        var target = e.target;

        if(!checkbox.checked ||
         sidebar.contains(target) ||
         (target === checkbox || target === toggle)) return;

          checkbox.checked = false;
      }, false);
    })(document);
    </script>

    
  </body>
  </html>
